<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MQTTSuite: mqttbroker/mqttbroker.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MQTTSuite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mqttbroker_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mqttbroker.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mqttbroker_2SocketContextFactory_8h_source.html">SocketContextFactory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mqttbroker_2lib_2Mqtt_8h_source.html">lib/Mqtt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MqttModel_8h_source.html">lib/MqttModel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="inja_8hpp_source.html">lib/inja.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mqttbroker.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="mqttbroker_8cpp__incl.svg" width="100%" height="448"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="mqttbroker_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abcf60cb690f64fa70b8f3728e1de0759" id="r_abcf60cb690f64fa70b8f3728e1de0759"><td class="memItemLeft" align="right" valign="top">static void upgrade&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a> (req, res)</td></tr>
<tr class="separator:abcf60cb690f64fa70b8f3728e1de0759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a2989a69eb2abb480616f166598a89" id="r_a41a2989a69eb2abb480616f166598a89"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a> (const std::string &amp;text, const std::string &amp;link)</td></tr>
<tr class="separator:a41a2989a69eb2abb480616f166598a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dfd7c4353c3e607ddb8f6b0d920db36" id="r_a9dfd7c4353c3e607ddb8f6b0d920db36"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a9dfd7c4353c3e607ddb8f6b0d920db36">href</a> (const std::string &amp;text, const std::string &amp;url, const std::string &amp;windowId, uint16_t width, uint16_t height)</td></tr>
<tr class="separator:a9dfd7c4353c3e607ddb8f6b0d920db36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d315824898337732fd1b67f05846c9" id="r_ad9d315824898337732fd1b67f05846c9"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#ad9d315824898337732fd1b67f05846c9">getOverviewPage</a> (<a class="el" href="classinja_1_1Environment.html">inja::Environment</a> environment, std::shared_ptr&lt; iot::mqtt::server::broker::Broker &gt; broker, <a class="el" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html">mqtt::mqttbroker::lib::MqttModel</a> &amp;mqttModel)</td></tr>
<tr class="separator:ad9d315824898337732fd1b67f05846c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a049b5c955e78f60110433ce59da71607" id="r_a049b5c955e78f60110433ce59da71607"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a049b5c955e78f60110433ce59da71607">getDetailedPage</a> (<a class="el" href="classinja_1_1Environment.html">inja::Environment</a> environment, const <a class="el" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a> *mqtt)</td></tr>
<tr class="separator:a049b5c955e78f60110433ce59da71607"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaabce72814f1277ee38fab80aaa1f34" id="r_adaabce72814f1277ee38fab80aaa1f34"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#adaabce72814f1277ee38fab80aaa1f34">getRedirectSpinnerPage</a> (<a class="el" href="classinja_1_1Environment.html">inja::Environment</a> environment, const std::string &amp;location)</td></tr>
<tr class="separator:adaabce72814f1277ee38fab80aaa1f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060eea8fb783d5b54f6fa11cf4e32be9" id="r_a060eea8fb783d5b54f6fa11cf4e32be9"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a060eea8fb783d5b54f6fa11cf4e32be9">urlDecode</a> (const std::string &amp;encoded)</td></tr>
<tr class="separator:a060eea8fb783d5b54f6fa11cf4e32be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a760fc46c377e0486748aceb5686e3741" id="r_a760fc46c377e0486748aceb5686e3741"><td class="memItemLeft" align="right" valign="top">static express::Router&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a760fc46c377e0486748aceb5686e3741">getRouter</a> (<a class="el" href="classinja_1_1Environment.html">inja::Environment</a> environment, std::shared_ptr&lt; iot::mqtt::server::broker::Broker &gt; broker)</td></tr>
<tr class="separator:a760fc46c377e0486748aceb5686e3741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb8447e3290d506bf8a79ddeca2c7d0" id="r_a7cb8447e3290d506bf8a79ddeca2c7d0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a> (const std::string &amp;instanceName, const core::socket::SocketAddress &amp;socketAddress, const core::socket::State &amp;state)</td></tr>
<tr class="separator:a7cb8447e3290d506bf8a79ddeca2c7d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd5000706dbaec44e9b35f57f8bd27f" id="r_a9bd5000706dbaec44e9b35f57f8bd27f"><td class="memTemplParams" colspan="2">template&lt;typename HttpExpressServer &gt; </td></tr>
<tr class="memitem:a9bd5000706dbaec44e9b35f57f8bd27f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a9bd5000706dbaec44e9b35f57f8bd27f">startServer</a> (const std::string &amp;instanceName, const express::Router &amp;router, const std::function&lt; void(typename HttpExpressServer::Config &amp;)&gt; &amp;configurator=nullptr)</td></tr>
<tr class="separator:a9bd5000706dbaec44e9b35f57f8bd27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqttbroker_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abcf60cb690f64fa70b8f3728e1de0759" name="abcf60cb690f64fa70b8f3728e1de0759"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf60cb690f64fa70b8f3728e1de0759">&#9670;&#160;</a></span>APPLICATION()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void upgrade APPLICATION </td>
          <td>(</td>
          <td class="paramtype">req&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">res&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00094">94</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>                                          {</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">if</span> (req-&gt;get(<span class="stringliteral">&quot;sec-websocket-protocol&quot;</span>).find(<span class="stringliteral">&quot;mqtt&quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno">   96</span>        res-&gt;upgrade(req, [req, res](<span class="keyword">const</span> std::string&amp; name) {</div>
<div class="line"><span class="lineno">   97</span>            <span class="keywordflow">if</span> (!name.empty()) {</div>
<div class="line"><span class="lineno">   98</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Successful upgrade to &#39;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;  requested: &quot;</span> &lt;&lt; req-&gt;get(<span class="stringliteral">&quot;upgrade&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  100</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Can not upgrade to any of &#39;&quot;</span> &lt;&lt; req-&gt;get(<span class="stringliteral">&quot;upgrade&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><span class="lineno">  101</span>            }</div>
<div class="line"><span class="lineno">  102</span>            res-&gt;end();</div>
<div class="line"><span class="lineno">  103</span>        });</div>
<div class="line"><span class="lineno">  104</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  105</span>        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Not supporting any of: &quot;</span> &lt;&lt; req-&gt;get(<span class="stringliteral">&quot;sec-websocket-protocol&quot;</span>);</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>        res-&gt;sendStatus(404);</div>
<div class="line"><span class="lineno">  108</span>    }</div>
<div class="line"><span class="lineno">  109</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a049b5c955e78f60110433ce59da71607" name="a049b5c955e78f60110433ce59da71607"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a049b5c955e78f60110433ce59da71607">&#9670;&#160;</a></span>getDetailedPage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string getDetailedPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinja_1_1Environment.html">inja::Environment</a>&#160;</td>
          <td class="paramname"><em>environment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a> *&#160;</td>
          <td class="paramname"><em>mqtt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00207">207</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>                                                                                                 {</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">return</span> environment.<a class="code hl_function" href="classinja_1_1Environment.html#aaefdd9061b23f1764056689fe8c31e30">render_file</a>(<span class="stringliteral">&quot;DetailPage.html&quot;</span>,</div>
<div class="line"><span class="lineno">  209</span>                                   {{<span class="stringliteral">&quot;client_id&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId()},</div>
<div class="line"><span class="lineno">  210</span>                                    {<span class="stringliteral">&quot;title&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId()},</div>
<div class="line"><span class="lineno">  211</span>                                    {<span class="stringliteral">&quot;header_row&quot;</span>, {<span class="stringliteral">&quot;Attribute&quot;</span>, <span class="stringliteral">&quot;Value&quot;</span>}},</div>
<div class="line"><span class="lineno">  212</span>                                    {<span class="stringliteral">&quot;data_rows&quot;</span>,</div>
<div class="line"><span class="lineno">  213</span>                                     inja::json::array({{<span class="stringliteral">&quot;Client ID&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId()},</div>
<div class="line"><span class="lineno">  214</span>                                                        {<span class="stringliteral">&quot;Connection&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getConnectionName()},</div>
<div class="line"><span class="lineno">  215</span>                                                        {<span class="stringliteral">&quot;Clean Session&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getCleanSession() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>},</div>
<div class="line"><span class="lineno">  216</span>                                                        {<span class="stringliteral">&quot;Connect Flags&quot;</span>, std::to_string(<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getConnectFlags())},</div>
<div class="line"><span class="lineno">  217</span>                                                        {<span class="stringliteral">&quot;Username&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getUsername()},</div>
<div class="line"><span class="lineno">  218</span>                                                        {<span class="stringliteral">&quot;Username Flag&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getUsernameFlag() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>},</div>
<div class="line"><span class="lineno">  219</span>                                                        {<span class="stringliteral">&quot;Password&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getPassword()},</div>
<div class="line"><span class="lineno">  220</span>                                                        {<span class="stringliteral">&quot;Password Flag&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getPasswordFlag() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>},</div>
<div class="line"><span class="lineno">  221</span>                                                        {<span class="stringliteral">&quot;Keep Alive&quot;</span>, std::to_string(<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getKeepAlive())},</div>
<div class="line"><span class="lineno">  222</span>                                                        {<span class="stringliteral">&quot;Protocol&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getProtocol()},</div>
<div class="line"><span class="lineno">  223</span>                                                        {<span class="stringliteral">&quot;Protocol Level&quot;</span>, std::to_string(<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getLevel())},</div>
<div class="line"><span class="lineno">  224</span>                                                        {<span class="stringliteral">&quot;Loop Prevention&quot;</span>, !<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getReflect() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>},</div>
<div class="line"><span class="lineno">  225</span>                                                        {<span class="stringliteral">&quot;Will Message&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getWillMessage()},</div>
<div class="line"><span class="lineno">  226</span>                                                        {<span class="stringliteral">&quot;Will Topic&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getWillTopic()},</div>
<div class="line"><span class="lineno">  227</span>                                                        {<span class="stringliteral">&quot;Will QoS&quot;</span>, std::to_string(<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getWillQoS())},</div>
<div class="line"><span class="lineno">  228</span>                                                        {<span class="stringliteral">&quot;Will Flag&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getWillFlag() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>},</div>
<div class="line"><span class="lineno">  229</span>                                                        {<span class="stringliteral">&quot;Will Retain&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getWillRetain() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>}})},</div>
<div class="line"><span class="lineno">  230</span>                                    {<span class="stringliteral">&quot;client_id&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId()},</div>
<div class="line"><span class="lineno">  231</span>                                    {<span class="stringliteral">&quot;topics&quot;</span>, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getSubscriptions()}});</div>
<div class="line"><span class="lineno">  232</span>}</div>
<div class="ttc" id="aclassinja_1_1Environment_html_aaefdd9061b23f1764056689fe8c31e30"><div class="ttname"><a href="classinja_1_1Environment.html#aaefdd9061b23f1764056689fe8c31e30">inja::Environment::render_file</a></div><div class="ttdeci">std::string render_file(const std::string &amp;filename, const json &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l02958">inja.hpp:2958</a></div></div>
<div class="ttc" id="anamespacemqtt_html"><div class="ttname"><a href="namespacemqtt.html">mqtt</a></div><div class="ttdef"><b>Definition</b> <a href="JsonMappingReader_8cpp_source.html#l00055">JsonMappingReader.cpp:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9d315824898337732fd1b67f05846c9" name="ad9d315824898337732fd1b67f05846c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d315824898337732fd1b67f05846c9">&#9670;&#160;</a></span>getOverviewPage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string getOverviewPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinja_1_1Environment.html">inja::Environment</a>&#160;</td>
          <td class="paramname"><em>environment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; iot::mqtt::server::broker::Broker &gt;&#160;</td>
          <td class="paramname"><em>broker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html">mqtt::mqttbroker::lib::MqttModel</a> &amp;&#160;</td>
          <td class="paramname"><em>mqttModel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00135">135</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>                                                                          {</div>
<div class="line"><span class="lineno">  138</span>    <a class="code hl_typedef" href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a> <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;title&quot;</span>] = <span class="stringliteral">&quot;MQTTBroker | Active Clients&quot;</span>;</div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;voc&quot;</span>] = <a class="code hl_function" href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a>(<span class="stringliteral">&quot;Volker Christian&quot;</span>, <span class="stringliteral">&quot;https://github.com/VolkerChristian/&quot;</span>);</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;broker&quot;</span>] = <a class="code hl_function" href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a>(<span class="stringliteral">&quot;MQTTBroker&quot;</span>, <span class="stringliteral">&quot;https://github.com/SNodeC/mqttsuite/tree/master/mqttbroker&quot;</span>);</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;suite&quot;</span>] = <a class="code hl_function" href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a>(<span class="stringliteral">&quot;MQTTSuite&quot;</span>, <span class="stringliteral">&quot;https://github.com/SNodeC/mqttsuite&quot;</span>);</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;snodec&quot;</span>] = <span class="stringliteral">&quot;Powered by &quot;</span> + <a class="code hl_function" href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a>(<span class="stringliteral">&quot;SNode.C&quot;</span>, <span class="stringliteral">&quot;https://github.com/SNodeC/snode.c&quot;</span>);</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;since&quot;</span>] = mqttModel.<a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a91fc1ed46bf75fded412034533ea60ce">onlineSince</a>();</div>
<div class="line"><span class="lineno">  146</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;duration&quot;</span>] = mqttModel.<a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a9423a3d458e7642931e54069583ac30d">onlineDuration</a>();</div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;header_row&quot;</span>] = {<span class="stringliteral">&quot;Client ID&quot;</span>, <span class="stringliteral">&quot;Online Since&quot;</span>, <span class="stringliteral">&quot;Duration&quot;</span>, <span class="stringliteral">&quot;Connection&quot;</span>, <span class="stringliteral">&quot;Local Address&quot;</span>, <span class="stringliteral">&quot;Remote Address&quot;</span>, <span class="stringliteral">&quot;Action&quot;</span>};</div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;data_rows&quot;</span>] = inja::json::array();</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;subscribed_topics&quot;</span>] = inja::json::array();</div>
<div class="line"><span class="lineno">  150</span>    <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;retained_topics&quot;</span>] = inja::json::array();</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_typedef" href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a>&amp; jsonDataRows = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;data_rows&quot;</span>];</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [connectionName, mqttModelEntry] : mqttModel.getClients()) {</div>
<div class="line"><span class="lineno">  154</span>        <span class="keyword">const</span> <a class="code hl_class" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a>* <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> = mqttModelEntry.getMqtt();</div>
<div class="line"><span class="lineno">  155</span>        <span class="keyword">const</span> core::socket::stream::SocketConnection* socketConnection = <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getMqttContext()-&gt;getSocketConnection();</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>        std::ostringstream windowId(<span class="stringliteral">&quot;window&quot;</span>);</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">for</span> (<span class="keywordtype">char</span> ch : <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId()) {</div>
<div class="line"><span class="lineno">  159</span>            <span class="keywordflow">if</span> (std::isalnum(<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(ch))) {</div>
<div class="line"><span class="lineno">  160</span>                windowId &lt;&lt; ch;</div>
<div class="line"><span class="lineno">  161</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  162</span>                windowId &lt;&lt; std::hex &lt;&lt; std::uppercase &lt;&lt; std::setw(2) &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>)</div>
<div class="line"><span class="lineno">  163</span>                         &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(ch));</div>
<div class="line"><span class="lineno">  164</span>            }</div>
<div class="line"><span class="lineno">  165</span>        }</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        jsonDataRows.push_back(</div>
<div class="line"><span class="lineno">  168</span>            {<a class="code hl_function" href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a>(<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId(), <span class="stringliteral">&quot;/client?&quot;</span> + <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId(), windowId.str(), 450, 900),</div>
<div class="line"><span class="lineno">  169</span>             mqttModelEntry.onlineSince(),</div>
<div class="line"><span class="lineno">  170</span>             <span class="stringliteral">&quot;&lt;duration&gt;&quot;</span> + mqttModelEntry.onlineDuration() + <span class="stringliteral">&quot;&lt;/duration&gt;&quot;</span>,</div>
<div class="line"><span class="lineno">  171</span>             <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getConnectionName(),</div>
<div class="line"><span class="lineno">  172</span>             socketConnection-&gt;getLocalAddress().toString(),</div>
<div class="line"><span class="lineno">  173</span>             socketConnection-&gt;getRemoteAddress().toString(),</div>
<div class="line"><span class="lineno">  174</span>             <span class="stringliteral">&quot;&lt;button class=\&quot;red-btn\&quot; onClick=\&quot;disconnectClient(&#39;&quot;</span> + <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId() + <span class="stringliteral">&quot;&#39;)\&quot;&gt;Disconnect&lt;/button&gt;&quot;</span>});</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    std::map&lt;std::string, std::list&lt;std::pair&lt;std::string, uint8_t&gt;&gt;&gt; subscribedTopics = broker-&gt;getSubscriptionTree();</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <a class="code hl_typedef" href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a>&amp; subscribedTopicsJson = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;subscribed_topics&quot;</span>];</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [topic, clients] : subscribedTopics) {</div>
<div class="line"><span class="lineno">  181</span>        <a class="code hl_typedef" href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a> topicJson;</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>        topicJson[<span class="stringliteral">&quot;key&quot;</span>] = topic;</div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; client : clients) {</div>
<div class="line"><span class="lineno">  185</span>            topicJson[<span class="stringliteral">&quot;values&quot;</span>].push_back(</div>
<div class="line"><span class="lineno">  186</span>                {{<span class="stringliteral">&quot;client_id&quot;</span>, client.first}, {<span class="stringliteral">&quot;topic&quot;</span>, topic}, {<span class="stringliteral">&quot;qos&quot;</span>, std::to_string(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(client.second))}});</div>
<div class="line"><span class="lineno">  187</span>        }</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>        subscribedTopicsJson.push_back(topicJson);</div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    std::list&lt;std::pair&lt;std::string, std::string&gt;&gt; retainTree = broker-&gt;getRetainTree();</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_typedef" href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a>&amp; retainedTopicsJson = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;retained_topics&quot;</span>];</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [topic, message] : retainTree) {</div>
<div class="line"><span class="lineno">  196</span>        <a class="code hl_typedef" href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a> topicJson;</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>        topicJson[<span class="stringliteral">&quot;key&quot;</span>] = topic;</div>
<div class="line"><span class="lineno">  199</span>        topicJson[<span class="stringliteral">&quot;values&quot;</span>].push_back(message);</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>        retainedTopicsJson.push_back(topicJson);</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">return</span> environment.<a class="code hl_function" href="classinja_1_1Environment.html#aaefdd9061b23f1764056689fe8c31e30">render_file</a>(<span class="stringliteral">&quot;OverviewPage.html&quot;</span>, <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>);</div>
<div class="line"><span class="lineno">  205</span>}</div>
<div class="ttc" id="abinary-validation_8cpp_html_a2fec365798124ac10ddd238c0b075720"><div class="ttname"><a href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition</b> <a href="binary-validation_8cpp_source.html#l00030">binary-validation.cpp:30</a></div></div>
<div class="ttc" id="aclassmqtt_1_1mqttbroker_1_1lib_1_1MqttModel_html_a91fc1ed46bf75fded412034533ea60ce"><div class="ttname"><a href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a91fc1ed46bf75fded412034533ea60ce">mqtt::mqttbroker::lib::MqttModel::onlineSince</a></div><div class="ttdeci">std::string onlineSince()</div><div class="ttdef"><b>Definition</b> <a href="MqttModel_8cpp_source.html#l00088">MqttModel.cpp:88</a></div></div>
<div class="ttc" id="aclassmqtt_1_1mqttbroker_1_1lib_1_1MqttModel_html_a9423a3d458e7642931e54069583ac30d"><div class="ttname"><a href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a9423a3d458e7642931e54069583ac30d">mqtt::mqttbroker::lib::MqttModel::onlineDuration</a></div><div class="ttdeci">std::string onlineDuration()</div><div class="ttdef"><b>Definition</b> <a href="MqttModel_8cpp_source.html#l00092">MqttModel.cpp:92</a></div></div>
<div class="ttc" id="aclassmqtt_1_1mqttbroker_1_1lib_1_1Mqtt_html"><div class="ttname"><a href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a></div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_2lib_2Mqtt_8h_source.html#l00063">Mqtt.h:65</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_a41a2989a69eb2abb480616f166598a89"><div class="ttname"><a href="mqttbroker_8cpp.html#a41a2989a69eb2abb480616f166598a89">href</a></div><div class="ttdeci">static std::string href(const std::string &amp;text, const std::string &amp;link)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00111">mqttbroker.cpp:111</a></div></div>
<div class="ttc" id="anamespaceinja_html_abd4af4a50124615d94feefd32ccc7933"><div class="ttname"><a href="namespaceinja.html#abd4af4a50124615d94feefd32ccc7933">inja::json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition</b> <a href="MqttMapperPlugin_8h_source.html#l00058">MqttMapperPlugin.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adaabce72814f1277ee38fab80aaa1f34" name="adaabce72814f1277ee38fab80aaa1f34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaabce72814f1277ee38fab80aaa1f34">&#9670;&#160;</a></span>getRedirectSpinnerPage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string getRedirectSpinnerPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinja_1_1Environment.html">inja::Environment</a>&#160;</td>
          <td class="paramname"><em>environment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>location</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00234">234</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  234</span>                                                                                                {</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">return</span> environment.<a class="code hl_function" href="classinja_1_1Environment.html#aaefdd9061b23f1764056689fe8c31e30">render_file</a>(<span class="stringliteral">&quot;Spinner.html&quot;</span>, {{<span class="stringliteral">&quot;location&quot;</span>, location}});</div>
<div class="line"><span class="lineno">  236</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a760fc46c377e0486748aceb5686e3741" name="a760fc46c377e0486748aceb5686e3741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a760fc46c377e0486748aceb5686e3741">&#9670;&#160;</a></span>getRouter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static express::Router getRouter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classinja_1_1Environment.html">inja::Environment</a>&#160;</td>
          <td class="paramname"><em>environment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; iot::mqtt::server::broker::Broker &gt;&#160;</td>
          <td class="paramname"><em>broker</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00271">271</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  271</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  272</span>    <span class="keyword">const</span> express::Router router;</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="keyword">const</span> express::Router&amp; jsonRouter = express::middleware::JsonMiddleware();</div>
<div class="line"><span class="lineno">  275</span>    jsonRouter.setStrictRouting();</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    jsonRouter.post(<span class="stringliteral">&quot;/disconnect&quot;</span>, [] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  278</span>        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;POST /disconnect&quot;</span>;</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>        req-&gt;getAttribute&lt;nlohmann::json&gt;(</div>
<div class="line"><span class="lineno">  281</span>            [&amp;res](nlohmann::json&amp; <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>) {</div>
<div class="line"><span class="lineno">  282</span>                std::string jsonString = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>.dump(4);</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>                VLOG(1) &lt;&lt; jsonString;</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>                std::string clientId = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;client_id&quot;</span>].get&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  287</span>                <span class="keyword">const</span> <a class="code hl_class" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a>* <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> = <a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a472d48d30d9626c722b64ddce4002e5f">mqtt::mqttbroker::lib::MqttModel::instance</a>().<a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#ab7589b5b3019346fa6c381b2dbde42bf">getMqtt</a>(clientId);</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>                <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  290</span>                    <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getMqttContext()-&gt;getSocketConnection()-&gt;close();</div>
<div class="line"><span class="lineno">  291</span>                    res-&gt;send(jsonString);</div>
<div class="line"><span class="lineno">  292</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  293</span>                    res-&gt;status(404).send(<span class="stringliteral">&quot;MQTT client has never existed or already gone away: &#39;&quot;</span> + clientId + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  294</span>                }</div>
<div class="line"><span class="lineno">  295</span>            },</div>
<div class="line"><span class="lineno">  296</span>            [&amp;res](<span class="keyword">const</span> std::string&amp; key) {</div>
<div class="line"><span class="lineno">  297</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Attribute type not found: &quot;</span> &lt;&lt; key;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>                res-&gt;status(400).send(<span class="stringliteral">&quot;Attribute type not found: &quot;</span> + key);</div>
<div class="line"><span class="lineno">  300</span>            });</div>
<div class="line"><span class="lineno">  301</span>    });</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    jsonRouter.post(<span class="stringliteral">&quot;/unsubscribe&quot;</span>, [] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  304</span>        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;POST /unsubscribe&quot;</span>;</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        req-&gt;getAttribute&lt;nlohmann::json&gt;(</div>
<div class="line"><span class="lineno">  307</span>            [&amp;res](nlohmann::json&amp; <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>) {</div>
<div class="line"><span class="lineno">  308</span>                std::string jsonString = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>.dump(4);</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>                VLOG(1) &lt;&lt; jsonString;</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>                std::string clientId = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;client_id&quot;</span>].get&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  313</span>                std::string topic = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;topic&quot;</span>].get&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>                <span class="keyword">const</span> <a class="code hl_class" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a>* <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> = <a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a472d48d30d9626c722b64ddce4002e5f">mqtt::mqttbroker::lib::MqttModel::instance</a>().<a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#ab7589b5b3019346fa6c381b2dbde42bf">getMqtt</a>(clientId);</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  318</span>                    <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;unsubscribe(topic);</div>
<div class="line"><span class="lineno">  319</span>                    res-&gt;send(jsonString);</div>
<div class="line"><span class="lineno">  320</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  321</span>                    res-&gt;status(404).send(<span class="stringliteral">&quot;MQTT client has never existed or already gone away: &#39;&quot;</span> + clientId + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  322</span>                }</div>
<div class="line"><span class="lineno">  323</span>            },</div>
<div class="line"><span class="lineno">  324</span>            [&amp;res](<span class="keyword">const</span> std::string&amp; key) {</div>
<div class="line"><span class="lineno">  325</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Attribute type not found: &quot;</span> &lt;&lt; key;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>                res-&gt;status(400).send(<span class="stringliteral">&quot;Attribute type not found: &quot;</span> + key);</div>
<div class="line"><span class="lineno">  328</span>            });</div>
<div class="line"><span class="lineno">  329</span>    });</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    jsonRouter.post(<span class="stringliteral">&quot;/release&quot;</span>, [broker] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  332</span>        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;POST /release&quot;</span>;</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>        req-&gt;getAttribute&lt;nlohmann::json&gt;(</div>
<div class="line"><span class="lineno">  335</span>            [&amp;res, broker](nlohmann::json&amp; <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>) {</div>
<div class="line"><span class="lineno">  336</span>                std::string jsonString = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>.dump(4);</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>                VLOG(1) &lt;&lt; jsonString;</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>                std::string topic = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;topic&quot;</span>].get&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>                broker-&gt;release(topic);</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>                res-&gt;send(jsonString);</div>
<div class="line"><span class="lineno">  345</span>            },</div>
<div class="line"><span class="lineno">  346</span>            [&amp;res](<span class="keyword">const</span> std::string&amp; key) {</div>
<div class="line"><span class="lineno">  347</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Attribute type not found: &quot;</span> &lt;&lt; key;</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>                res-&gt;status(400).send(<span class="stringliteral">&quot;Attribute type not found: &quot;</span> + key);</div>
<div class="line"><span class="lineno">  350</span>            });</div>
<div class="line"><span class="lineno">  351</span>    });</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    jsonRouter.post(<span class="stringliteral">&quot;/subscribe&quot;</span>, [] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  354</span>        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;POST /subscribe&quot;</span>;</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>        req-&gt;getAttribute&lt;nlohmann::json&gt;(</div>
<div class="line"><span class="lineno">  357</span>            [&amp;res](nlohmann::json&amp; <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>) {</div>
<div class="line"><span class="lineno">  358</span>                std::string jsonString = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>.dump(4);</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>                VLOG(1) &lt;&lt; jsonString;</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>                std::string clientId = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;client_id&quot;</span>].get&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  363</span>                std::string topic = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;topic&quot;</span>].get&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  364</span>                uint8_t qoS = <a class="code hl_typedef" href="binary-validation_8cpp.html#a2fec365798124ac10ddd238c0b075720">json</a>[<span class="stringliteral">&quot;qos&quot;</span>].get&lt;uint8_t&gt;();</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>                <span class="keyword">const</span> <a class="code hl_class" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a>* <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> = <a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a472d48d30d9626c722b64ddce4002e5f">mqtt::mqttbroker::lib::MqttModel::instance</a>().<a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#ab7589b5b3019346fa6c381b2dbde42bf">getMqtt</a>(clientId);</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>                <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  369</span>                    <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;subscribe(topic, qoS);</div>
<div class="line"><span class="lineno">  370</span>                    res-&gt;send(jsonString);</div>
<div class="line"><span class="lineno">  371</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  372</span>                    res-&gt;status(404).send(<span class="stringliteral">&quot;MQTT client has never existed or already gone away: &#39;&quot;</span> + clientId + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  373</span>                }</div>
<div class="line"><span class="lineno">  374</span>            },</div>
<div class="line"><span class="lineno">  375</span>            [&amp;res](<span class="keyword">const</span> std::string&amp; key) {</div>
<div class="line"><span class="lineno">  376</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Attribute type not found: &quot;</span> &lt;&lt; key;</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>                res-&gt;status(400).send(<span class="stringliteral">&quot;Attribute type not found: &quot;</span> + key);</div>
<div class="line"><span class="lineno">  379</span>            });</div>
<div class="line"><span class="lineno">  380</span>    });</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    router.use(jsonRouter);</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    router.get(<span class="stringliteral">&quot;/clients&quot;</span>, [environment, broker] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  385</span>        std::string responseString;</div>
<div class="line"><span class="lineno">  386</span>        <span class="keywordtype">int</span> responseStatus = 200;</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  389</span>            responseString = <a class="code hl_function" href="mqttbroker_8cpp.html#ad9d315824898337732fd1b67f05846c9">getOverviewPage</a>(environment, broker, <a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a472d48d30d9626c722b64ddce4002e5f">mqtt::mqttbroker::lib::MqttModel::instance</a>());</div>
<div class="line"><span class="lineno">  390</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structinja_1_1InjaError.html">inja::InjaError</a>&amp; error) {</div>
<div class="line"><span class="lineno">  391</span>            responseStatus = 500;</div>
<div class="line"><span class="lineno">  392</span>            responseString = <span class="stringliteral">&quot;Internal Server Error\n&quot;</span>;</div>
<div class="line"><span class="lineno">  393</span>            responseString += std::string(error.what()) + <span class="stringliteral">&quot; &quot;</span> + error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a427af6ae1ff2209118a01c03a6f650a1">type</a> + <span class="stringliteral">&quot; &quot;</span> + error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a632ac8e10b0f029b6ca4efa5b0378877">message</a> + <span class="stringliteral">&quot; &quot;</span> +</div>
<div class="line"><span class="lineno">  394</span>                              std::to_string(error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a42b0040364f55512c36ae90303fad033">location</a>.<a class="code hl_variable" href="structinja_1_1SourceLocation.html#a1e2fa7b29c73a132931c0cdd0ebd0d80">line</a>) + <span class="stringliteral">&quot;:&quot;</span> + std::to_string(error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a42b0040364f55512c36ae90303fad033">location</a>.<a class="code hl_variable" href="structinja_1_1SourceLocation.html#af30f2583f88e64efd5b1866feb8b4703">column</a>);</div>
<div class="line"><span class="lineno">  395</span>        }</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>        res-&gt;status(responseStatus).send(responseString);</div>
<div class="line"><span class="lineno">  398</span>    });</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    router.get(<span class="stringliteral">&quot;/client&quot;</span>, [environment] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  401</span>        std::string responseString;</div>
<div class="line"><span class="lineno">  402</span>        <span class="keywordtype">int</span> responseStatus = 200;</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">if</span> (req-&gt;queries.size() == 1) {</div>
<div class="line"><span class="lineno">  405</span>            <span class="keyword">const</span> <a class="code hl_class" href="classmqtt_1_1mqttbroker_1_1lib_1_1Mqtt.html">mqtt::mqttbroker::lib::Mqtt</a>* <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> =</div>
<div class="line"><span class="lineno">  406</span>                <a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a472d48d30d9626c722b64ddce4002e5f">mqtt::mqttbroker::lib::MqttModel::instance</a>().<a class="code hl_function" href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#ab7589b5b3019346fa6c381b2dbde42bf">getMqtt</a>(<a class="code hl_function" href="mqttbroker_8cpp.html#a060eea8fb783d5b54f6fa11cf4e32be9">urlDecode</a>(req-&gt;queries.begin()-&gt;first));</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespacemqtt.html">mqtt</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  409</span>                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Subscriptions for client &quot;</span> &lt;&lt; <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getClientId();</div>
<div class="line"><span class="lineno">  410</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; subscription : <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>-&gt;getSubscriptions()) {</div>
<div class="line"><span class="lineno">  411</span>                    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; subscription;</div>
<div class="line"><span class="lineno">  412</span>                }</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>                <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  415</span>                    responseString = <a class="code hl_function" href="mqttbroker_8cpp.html#a049b5c955e78f60110433ce59da71607">getDetailedPage</a>(environment, <a class="code hl_namespace" href="namespacemqtt.html">mqtt</a>);</div>
<div class="line"><span class="lineno">  416</span>                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structinja_1_1InjaError.html">inja::InjaError</a>&amp; error) {</div>
<div class="line"><span class="lineno">  417</span>                    responseStatus = 500;</div>
<div class="line"><span class="lineno">  418</span>                    responseString = <span class="stringliteral">&quot;Internal Server Error\n&quot;</span>;</div>
<div class="line"><span class="lineno">  419</span>                    responseString += std::string(error.what()) + <span class="stringliteral">&quot; &quot;</span> + error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a427af6ae1ff2209118a01c03a6f650a1">type</a> + <span class="stringliteral">&quot; &quot;</span> + error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a632ac8e10b0f029b6ca4efa5b0378877">message</a> + <span class="stringliteral">&quot; &quot;</span> +</div>
<div class="line"><span class="lineno">  420</span>                                      std::to_string(error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a42b0040364f55512c36ae90303fad033">location</a>.<a class="code hl_variable" href="structinja_1_1SourceLocation.html#a1e2fa7b29c73a132931c0cdd0ebd0d80">line</a>) + <span class="stringliteral">&quot;:&quot;</span> + std::to_string(error.<a class="code hl_variable" href="structinja_1_1InjaError.html#a42b0040364f55512c36ae90303fad033">location</a>.<a class="code hl_variable" href="structinja_1_1SourceLocation.html#af30f2583f88e64efd5b1866feb8b4703">column</a>);</div>
<div class="line"><span class="lineno">  421</span>                }</div>
<div class="line"><span class="lineno">  422</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  423</span>                responseStatus = 404;</div>
<div class="line"><span class="lineno">  424</span>                responseString = <span class="stringliteral">&quot;Not Found: &quot;</span> + <a class="code hl_function" href="mqttbroker_8cpp.html#a060eea8fb783d5b54f6fa11cf4e32be9">urlDecode</a>(req-&gt;queries.begin()-&gt;first);</div>
<div class="line"><span class="lineno">  425</span>            }</div>
<div class="line"><span class="lineno">  426</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  427</span>            responseStatus = 400;</div>
<div class="line"><span class="lineno">  428</span>            responseString = <span class="stringliteral">&quot;Bad Request: No Client requested&quot;</span>;</div>
<div class="line"><span class="lineno">  429</span>        }</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>        res-&gt;status(responseStatus).send(responseString);</div>
<div class="line"><span class="lineno">  432</span>    });</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    router.get(<span class="stringliteral">&quot;/spinner&quot;</span>, [environment] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  435</span>        std::string responseString;</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordtype">int</span> responseStatus = 200;</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">if</span> (req-&gt;queries.size() == 1) {</div>
<div class="line"><span class="lineno">  439</span>            responseString = <a class="code hl_function" href="mqttbroker_8cpp.html#adaabce72814f1277ee38fab80aaa1f34">getRedirectSpinnerPage</a>(environment, req-&gt;queries.begin()-&gt;first);</div>
<div class="line"><span class="lineno">  440</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  441</span>            responseStatus = 400;</div>
<div class="line"><span class="lineno">  442</span>            responseString = <span class="stringliteral">&quot;Bad Request: No Client requested&quot;</span>;</div>
<div class="line"><span class="lineno">  443</span>        }</div>
<div class="line"><span class="lineno">  444</span>        res-&gt;status(responseStatus).send(responseString);</div>
<div class="line"><span class="lineno">  445</span>    });</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    router</div>
<div class="line"><span class="lineno">  448</span>        .get(<span class="stringliteral">&quot;/ws&quot;</span>,</div>
<div class="line"><span class="lineno">  449</span>             [] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  450</span>                 <span class="keywordflow">if</span> (req-&gt;headers.contains(<span class="stringliteral">&quot;upgrade&quot;</span>)) {</div>
<div class="line"><span class="lineno">  451</span>                     upgrade(req, res);</div>
<div class="line"><span class="lineno">  452</span>                 } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  453</span>                     res-&gt;redirect(<span class="stringliteral">&quot;/spinner?/clients&quot;</span>);</div>
<div class="line"><span class="lineno">  454</span>                 }</div>
<div class="line"><span class="lineno">  455</span>             })</div>
<div class="line"><span class="lineno">  456</span>        .setStrictRouting();</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    router</div>
<div class="line"><span class="lineno">  459</span>        .get(<span class="stringliteral">&quot;/mqtt&quot;</span>,</div>
<div class="line"><span class="lineno">  460</span>             [] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  461</span>                 <span class="keywordflow">if</span> (req-&gt;headers.contains(<span class="stringliteral">&quot;upgrade&quot;</span>)) {</div>
<div class="line"><span class="lineno">  462</span>                     upgrade(req, res);</div>
<div class="line"><span class="lineno">  463</span>                 } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  464</span>                     res-&gt;redirect(<span class="stringliteral">&quot;/spinner?/clients&quot;</span>);</div>
<div class="line"><span class="lineno">  465</span>                 }</div>
<div class="line"><span class="lineno">  466</span>             })</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>        .setStrictRouting();</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    router</div>
<div class="line"><span class="lineno">  471</span>        .get(<span class="stringliteral">&quot;/&quot;</span>,</div>
<div class="line"><span class="lineno">  472</span>             [] <a class="code hl_function" href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a>(req, res) {</div>
<div class="line"><span class="lineno">  473</span>                 <span class="keywordflow">if</span> (req-&gt;headers.contains(<span class="stringliteral">&quot;upgrade&quot;</span>)) {</div>
<div class="line"><span class="lineno">  474</span>                     upgrade(req, res);</div>
<div class="line"><span class="lineno">  475</span>                 } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  476</span>                     res-&gt;redirect(<span class="stringliteral">&quot;/spinner?/clients&quot;</span>);</div>
<div class="line"><span class="lineno">  477</span>                 }</div>
<div class="line"><span class="lineno">  478</span>             })</div>
<div class="line"><span class="lineno">  479</span>        .setStrictRouting();</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">return</span> router;</div>
<div class="line"><span class="lineno">  482</span>}</div>
<div class="ttc" id="aclassmqtt_1_1mqttbroker_1_1lib_1_1MqttModel_html_a472d48d30d9626c722b64ddce4002e5f"><div class="ttname"><a href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#a472d48d30d9626c722b64ddce4002e5f">mqtt::mqttbroker::lib::MqttModel::instance</a></div><div class="ttdeci">static MqttModel &amp; instance()</div><div class="ttdef"><b>Definition</b> <a href="MqttModel_8cpp_source.html#l00060">MqttModel.cpp:60</a></div></div>
<div class="ttc" id="aclassmqtt_1_1mqttbroker_1_1lib_1_1MqttModel_html_ab7589b5b3019346fa6c381b2dbde42bf"><div class="ttname"><a href="classmqtt_1_1mqttbroker_1_1lib_1_1MqttModel.html#ab7589b5b3019346fa6c381b2dbde42bf">mqtt::mqttbroker::lib::MqttModel::getMqtt</a></div><div class="ttdeci">const Mqtt * getMqtt(const std::string &amp;clientId)</div><div class="ttdef"><b>Definition</b> <a href="MqttModel_8cpp_source.html#l00078">MqttModel.cpp:78</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_a049b5c955e78f60110433ce59da71607"><div class="ttname"><a href="mqttbroker_8cpp.html#a049b5c955e78f60110433ce59da71607">getDetailedPage</a></div><div class="ttdeci">static std::string getDetailedPage(inja::Environment environment, const mqtt::mqttbroker::lib::Mqtt *mqtt)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00207">mqttbroker.cpp:207</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_a060eea8fb783d5b54f6fa11cf4e32be9"><div class="ttname"><a href="mqttbroker_8cpp.html#a060eea8fb783d5b54f6fa11cf4e32be9">urlDecode</a></div><div class="ttdeci">static std::string urlDecode(const std::string &amp;encoded)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00238">mqttbroker.cpp:238</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_abcf60cb690f64fa70b8f3728e1de0759"><div class="ttname"><a href="mqttbroker_8cpp.html#abcf60cb690f64fa70b8f3728e1de0759">APPLICATION</a></div><div class="ttdeci">static void upgrade APPLICATION(req, res)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00094">mqttbroker.cpp:94</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_ad9d315824898337732fd1b67f05846c9"><div class="ttname"><a href="mqttbroker_8cpp.html#ad9d315824898337732fd1b67f05846c9">getOverviewPage</a></div><div class="ttdeci">static std::string getOverviewPage(inja::Environment environment, std::shared_ptr&lt; iot::mqtt::server::broker::Broker &gt; broker, mqtt::mqttbroker::lib::MqttModel &amp;mqttModel)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00135">mqttbroker.cpp:135</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_adaabce72814f1277ee38fab80aaa1f34"><div class="ttname"><a href="mqttbroker_8cpp.html#adaabce72814f1277ee38fab80aaa1f34">getRedirectSpinnerPage</a></div><div class="ttdeci">static std::string getRedirectSpinnerPage(inja::Environment environment, const std::string &amp;location)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00234">mqttbroker.cpp:234</a></div></div>
<div class="ttc" id="astructinja_1_1InjaError_html"><div class="ttname"><a href="structinja_1_1InjaError.html">inja::InjaError</a></div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l00255">inja.hpp:255</a></div></div>
<div class="ttc" id="astructinja_1_1InjaError_html_a427af6ae1ff2209118a01c03a6f650a1"><div class="ttname"><a href="structinja_1_1InjaError.html#a427af6ae1ff2209118a01c03a6f650a1">inja::InjaError::type</a></div><div class="ttdeci">const std::string type</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l00256">inja.hpp:256</a></div></div>
<div class="ttc" id="astructinja_1_1InjaError_html_a42b0040364f55512c36ae90303fad033"><div class="ttname"><a href="structinja_1_1InjaError.html#a42b0040364f55512c36ae90303fad033">inja::InjaError::location</a></div><div class="ttdeci">const SourceLocation location</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l00259">inja.hpp:259</a></div></div>
<div class="ttc" id="astructinja_1_1InjaError_html_a632ac8e10b0f029b6ca4efa5b0378877"><div class="ttname"><a href="structinja_1_1InjaError.html#a632ac8e10b0f029b6ca4efa5b0378877">inja::InjaError::message</a></div><div class="ttdeci">const std::string message</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l00257">inja.hpp:257</a></div></div>
<div class="ttc" id="astructinja_1_1SourceLocation_html_a1e2fa7b29c73a132931c0cdd0ebd0d80"><div class="ttname"><a href="structinja_1_1SourceLocation.html#a1e2fa7b29c73a132931c0cdd0ebd0d80">inja::SourceLocation::line</a></div><div class="ttdeci">size_t line</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l00251">inja.hpp:251</a></div></div>
<div class="ttc" id="astructinja_1_1SourceLocation_html_af30f2583f88e64efd5b1866feb8b4703"><div class="ttname"><a href="structinja_1_1SourceLocation.html#af30f2583f88e64efd5b1866feb8b4703">inja::SourceLocation::column</a></div><div class="ttdeci">size_t column</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l00252">inja.hpp:252</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a41a2989a69eb2abb480616f166598a89" name="a41a2989a69eb2abb480616f166598a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41a2989a69eb2abb480616f166598a89">&#9670;&#160;</a></span>href() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string href </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>link</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00111">111</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  111</span>                                                                    {</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;a href=\&quot;&quot;</span> + link + <span class="stringliteral">&quot;\&quot; style=\&quot;color:inherit;\&quot;&gt;&quot;</span> + text + <span class="stringliteral">&quot;&lt;/a&gt;&quot;</span>;</div>
<div class="line"><span class="lineno">  113</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9dfd7c4353c3e607ddb8f6b0d920db36" name="a9dfd7c4353c3e607ddb8f6b0d920db36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dfd7c4353c3e607ddb8f6b0d920db36">&#9670;&#160;</a></span>href() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string href </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>windowId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>height</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00115">115</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  115</span>                                                                                                                               {</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;a href=\&quot;#\&quot; onClick=\&quot;&quot;</span></div>
<div class="line"><span class="lineno">  117</span>           <span class="stringliteral">&quot;let key = &#39;&quot;</span> +</div>
<div class="line"><span class="lineno">  118</span>           windowId +</div>
<div class="line"><span class="lineno">  119</span>           <span class="stringliteral">&quot;&#39;; &quot;</span></div>
<div class="line"><span class="lineno">  120</span>           <span class="stringliteral">&quot;if (!localStorage.getItem(key)) &quot;</span></div>
<div class="line"><span class="lineno">  121</span>           <span class="stringliteral">&quot;  localStorage.setItem(key, key + &#39;-&#39; + Math.random().toString(36).substr(2, 6)); &quot;</span></div>
<div class="line"><span class="lineno">  122</span>           <span class="stringliteral">&quot;let uniqueId = localStorage.getItem(key); &quot;</span></div>
<div class="line"><span class="lineno">  123</span>           <span class="stringliteral">&quot;if (!window._openWindows) window._openWindows = {}; &quot;</span></div>
<div class="line"><span class="lineno">  124</span>           <span class="stringliteral">&quot;if (!window._openWindows[uniqueId] || window._openWindows[uniqueId].closed) { &quot;</span></div>
<div class="line"><span class="lineno">  125</span>           <span class="stringliteral">&quot;  window._openWindows[uniqueId] = window.open(&#39;&quot;</span> +</div>
<div class="line"><span class="lineno">  126</span>           url + <span class="stringliteral">&quot;&#39;, uniqueId, &#39;width=&quot;</span> + std::to_string(width) + <span class="stringliteral">&quot;, height=&quot;</span> + std::to_string(height) +</div>
<div class="line"><span class="lineno">  127</span>           <span class="stringliteral">&quot;,location=no, menubar=no, status=no, toolbar=no&#39;); &quot;</span></div>
<div class="line"><span class="lineno">  128</span>           <span class="stringliteral">&quot;} else { &quot;</span></div>
<div class="line"><span class="lineno">  129</span>           <span class="stringliteral">&quot;  window._openWindows[uniqueId].focus(); &quot;</span></div>
<div class="line"><span class="lineno">  130</span>           <span class="stringliteral">&quot;} return false;\&quot; &quot;</span></div>
<div class="line"><span class="lineno">  131</span>           <span class="stringliteral">&quot;style=\&quot;color:inherit;\&quot;&gt;&quot;</span> +</div>
<div class="line"><span class="lineno">  132</span>           text + <span class="stringliteral">&quot;&lt;/a&gt;&quot;</span>;</div>
<div class="line"><span class="lineno">  133</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00525">525</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  525</span>                                 {</div>
<div class="line"><span class="lineno">  526</span>    utils::Config::addStringOption(<span class="stringliteral">&quot;--mqtt-mapping-file&quot;</span>, <span class="stringliteral">&quot;MQTT mapping file (json format) for integration&quot;</span>, <span class="stringliteral">&quot;[path]&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  527</span>    utils::Config::addStringOption(<span class="stringliteral">&quot;--mqtt-session-store&quot;</span>, <span class="stringliteral">&quot;Path to file for the persistent session store&quot;</span>, <span class="stringliteral">&quot;[path]&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  528</span>    utils::Config::addStringOption(</div>
<div class="line"><span class="lineno">  529</span>        <span class="stringliteral">&quot;--html-dir&quot;</span>, <span class="stringliteral">&quot;Path to html source directory&quot;</span>, <span class="stringliteral">&quot;[path]&quot;</span>, std::string(CMAKE_INSTALL_PREFIX) + <span class="stringliteral">&quot;/var/www/mqttsuite/mqttbroker&quot;</span>);</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    core::SNodeC::init(argc, argv);</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    std::shared_ptr&lt;iot::mqtt::server::broker::Broker&gt; broker =</div>
<div class="line"><span class="lineno">  534</span>        iot::mqtt::server::broker::Broker::instance(SUBSCRIBTION_MAX_QOS, utils::Config::getStringOptionValue(<span class="stringliteral">&quot;--mqtt-session-store&quot;</span>));</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    net::in::stream::legacy::Server&lt;mqtt::mqttbroker::SocketContextFactory&gt;(</div>
<div class="line"><span class="lineno">  537</span>        <span class="stringliteral">&quot;in-mqtt&quot;</span>,</div>
<div class="line"><span class="lineno">  538</span>        [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  539</span>            config.setPort(1883);</div>
<div class="line"><span class="lineno">  540</span>            config.setRetry();</div>
<div class="line"><span class="lineno">  541</span>            config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  542</span>        },</div>
<div class="line"><span class="lineno">  543</span>        broker)</div>
<div class="line"><span class="lineno">  544</span>        .listen([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; socketAddress, core::socket::State state) {</div>
<div class="line"><span class="lineno">  545</span>            <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(<span class="stringliteral">&quot;in-mqtt&quot;</span>, socketAddress, state);</div>
<div class="line"><span class="lineno">  546</span>        });</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    net::in::stream::tls::Server&lt;mqtt::mqttbroker::SocketContextFactory&gt;(</div>
<div class="line"><span class="lineno">  549</span>        <span class="stringliteral">&quot;in-mqtts&quot;</span>,</div>
<div class="line"><span class="lineno">  550</span>        [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  551</span>            config.setPort(8883);</div>
<div class="line"><span class="lineno">  552</span>            config.setRetry();</div>
<div class="line"><span class="lineno">  553</span>            config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  554</span>        },</div>
<div class="line"><span class="lineno">  555</span>        broker)</div>
<div class="line"><span class="lineno">  556</span>        .listen([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; socketAddress, core::socket::State state) {</div>
<div class="line"><span class="lineno">  557</span>            <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(<span class="stringliteral">&quot;in-mqtt&quot;</span>, socketAddress, state);</div>
<div class="line"><span class="lineno">  558</span>        });</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>    net::in6::stream::legacy::Server&lt;mqtt::mqttbroker::SocketContextFactory&gt;(</div>
<div class="line"><span class="lineno">  561</span>        <span class="stringliteral">&quot;in6-mqtt&quot;</span>,</div>
<div class="line"><span class="lineno">  562</span>        [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  563</span>            config.setPort(1883);</div>
<div class="line"><span class="lineno">  564</span>            config.setRetry();</div>
<div class="line"><span class="lineno">  565</span>            config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>            config.setIPv6Only();</div>
<div class="line"><span class="lineno">  568</span>        },</div>
<div class="line"><span class="lineno">  569</span>        broker)</div>
<div class="line"><span class="lineno">  570</span>        .listen([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; socketAddress, core::socket::State state) {</div>
<div class="line"><span class="lineno">  571</span>            <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(<span class="stringliteral">&quot;in-mqtt&quot;</span>, socketAddress, state);</div>
<div class="line"><span class="lineno">  572</span>        });</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    net::in6::stream::tls::Server&lt;mqtt::mqttbroker::SocketContextFactory&gt;(</div>
<div class="line"><span class="lineno">  575</span>        <span class="stringliteral">&quot;in6-mqtts&quot;</span>,</div>
<div class="line"><span class="lineno">  576</span>        [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  577</span>            config.setPort(8883);</div>
<div class="line"><span class="lineno">  578</span>            config.setRetry();</div>
<div class="line"><span class="lineno">  579</span>            config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>            config.setIPv6Only();</div>
<div class="line"><span class="lineno">  582</span>        },</div>
<div class="line"><span class="lineno">  583</span>        broker)</div>
<div class="line"><span class="lineno">  584</span>        .listen([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; socketAddress, core::socket::State state) {</div>
<div class="line"><span class="lineno">  585</span>            <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(<span class="stringliteral">&quot;in-mqtt&quot;</span>, socketAddress, state);</div>
<div class="line"><span class="lineno">  586</span>        });</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    net::un::stream::legacy::Server&lt;mqtt::mqttbroker::SocketContextFactory&gt;(</div>
<div class="line"><span class="lineno">  589</span>        <span class="stringliteral">&quot;un-mqtt&quot;</span>,</div>
<div class="line"><span class="lineno">  590</span>        [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  591</span>            config.setSunPath(<span class="stringliteral">&quot;/tmp/&quot;</span> + utils::Config::getApplicationName() + <span class="stringliteral">&quot;-&quot;</span> + config.getInstanceName());</div>
<div class="line"><span class="lineno">  592</span>            config.setRetry();</div>
<div class="line"><span class="lineno">  593</span>        },</div>
<div class="line"><span class="lineno">  594</span>        broker)</div>
<div class="line"><span class="lineno">  595</span>        .listen([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; socketAddress, core::socket::State state) {</div>
<div class="line"><span class="lineno">  596</span>            <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(<span class="stringliteral">&quot;in-mqtt&quot;</span>, socketAddress, state);</div>
<div class="line"><span class="lineno">  597</span>        });</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    net::un::stream::tls::Server&lt;mqtt::mqttbroker::SocketContextFactory&gt;(</div>
<div class="line"><span class="lineno">  600</span>        <span class="stringliteral">&quot;un-mqtts&quot;</span>,</div>
<div class="line"><span class="lineno">  601</span>        [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  602</span>            config.setSunPath(<span class="stringliteral">&quot;/tmp/&quot;</span> + utils::Config::getApplicationName() + <span class="stringliteral">&quot;-&quot;</span> + config.getInstanceName());</div>
<div class="line"><span class="lineno">  603</span>            config.setRetry();</div>
<div class="line"><span class="lineno">  604</span>        },</div>
<div class="line"><span class="lineno">  605</span>        broker)</div>
<div class="line"><span class="lineno">  606</span>        .listen([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; socketAddress, core::socket::State state) {</div>
<div class="line"><span class="lineno">  607</span>            <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(<span class="stringliteral">&quot;in-mqtt&quot;</span>, socketAddress, state);</div>
<div class="line"><span class="lineno">  608</span>        });</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>    <a class="code hl_class" href="classinja_1_1Environment.html">inja::Environment</a> environment{utils::Config::getStringOptionValue(<span class="stringliteral">&quot;--html-dir&quot;</span>) + <span class="stringliteral">&quot;/&quot;</span>};</div>
<div class="line"><span class="lineno">  611</span>    express::Router router = <a class="code hl_function" href="mqttbroker_8cpp.html#a760fc46c377e0486748aceb5686e3741">getRouter</a>(environment, broker);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    startServer&lt;express::legacy::in::WebApp&gt;(<span class="stringliteral">&quot;in-http&quot;</span>, router, [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  614</span>        config.setPort(8080);</div>
<div class="line"><span class="lineno">  615</span>        config.setRetry();</div>
<div class="line"><span class="lineno">  616</span>        config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  617</span>    });</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    startServer&lt;express::tls::in::WebApp&gt;(<span class="stringliteral">&quot;in-https&quot;</span>, router, [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  620</span>        config.setPort(8088);</div>
<div class="line"><span class="lineno">  621</span>        config.setRetry();</div>
<div class="line"><span class="lineno">  622</span>        config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  623</span>    });</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span>    startServer&lt;express::legacy::in6::WebApp&gt;(<span class="stringliteral">&quot;in6-http&quot;</span>, router, [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  626</span>        config.setPort(8080);</div>
<div class="line"><span class="lineno">  627</span>        config.setRetry();</div>
<div class="line"><span class="lineno">  628</span>        config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>        config.setIPv6Only();</div>
<div class="line"><span class="lineno">  631</span>    });</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>    startServer&lt;express::tls::in6::WebApp&gt;(<span class="stringliteral">&quot;in6-https&quot;</span>, router, [](<span class="keyword">auto</span>&amp; config) {</div>
<div class="line"><span class="lineno">  634</span>        config.setPort(8088);</div>
<div class="line"><span class="lineno">  635</span>        config.setRetry();</div>
<div class="line"><span class="lineno">  636</span>        config.setDisableNagleAlgorithm();</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>        config.setIPv6Only();</div>
<div class="line"><span class="lineno">  639</span>    });</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">return</span> core::SNodeC::start();</div>
<div class="line"><span class="lineno">  642</span>}</div>
<div class="ttc" id="aclassinja_1_1Environment_html"><div class="ttname"><a href="classinja_1_1Environment.html">inja::Environment</a></div><div class="ttdoc">Class for changing the configuration.</div><div class="ttdef"><b>Definition</b> <a href="inja_8hpp_source.html#l02851">inja.hpp:2851</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_a760fc46c377e0486748aceb5686e3741"><div class="ttname"><a href="mqttbroker_8cpp.html#a760fc46c377e0486748aceb5686e3741">getRouter</a></div><div class="ttdeci">static express::Router getRouter(inja::Environment environment, std::shared_ptr&lt; iot::mqtt::server::broker::Broker &gt; broker)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00271">mqttbroker.cpp:271</a></div></div>
<div class="ttc" id="amqttbroker_8cpp_html_a7cb8447e3290d506bf8a79ddeca2c7d0"><div class="ttname"><a href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a></div><div class="ttdeci">static void reportState(const std::string &amp;instanceName, const core::socket::SocketAddress &amp;socketAddress, const core::socket::State &amp;state)</div><div class="ttdef"><b>Definition</b> <a href="mqttbroker_8cpp_source.html#l00485">mqttbroker.cpp:485</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cb8447e3290d506bf8a79ddeca2c7d0" name="a7cb8447e3290d506bf8a79ddeca2c7d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb8447e3290d506bf8a79ddeca2c7d0">&#9670;&#160;</a></span>reportState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reportState </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>instanceName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const core::socket::SocketAddress &amp;&#160;</td>
          <td class="paramname"><em>socketAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const core::socket::State &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00485">485</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  485</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">switch</span> (state) {</div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordflow">case</span> core::socket::State::OK:</div>
<div class="line"><span class="lineno">  488</span>            VLOG(1) &lt;&lt; instanceName &lt;&lt; <span class="stringliteral">&quot;: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><span class="lineno">  489</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  490</span>        <span class="keywordflow">case</span> core::socket::State::DISABLED:</div>
<div class="line"><span class="lineno">  491</span>            VLOG(1) &lt;&lt; instanceName &lt;&lt; <span class="stringliteral">&quot;: disabled&quot;</span>;</div>
<div class="line"><span class="lineno">  492</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  493</span>        <span class="keywordflow">case</span> core::socket::State::ERROR:</div>
<div class="line"><span class="lineno">  494</span>            VLOG(1) &lt;&lt; instanceName &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.what();</div>
<div class="line"><span class="lineno">  495</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordflow">case</span> core::socket::State::FATAL:</div>
<div class="line"><span class="lineno">  497</span>            VLOG(1) &lt;&lt; instanceName &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.what();</div>
<div class="line"><span class="lineno">  498</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  499</span>    }</div>
<div class="line"><span class="lineno">  500</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bd5000706dbaec44e9b35f57f8bd27f" name="a9bd5000706dbaec44e9b35f57f8bd27f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bd5000706dbaec44e9b35f57f8bd27f">&#9670;&#160;</a></span>startServer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename HttpExpressServer &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void startServer </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>instanceName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const express::Router &amp;&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; void(typename HttpExpressServer::Config &amp;)&gt; &amp;&#160;</td>
          <td class="paramname"><em>configurator</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00503">503</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  505</span>                                                                                                     {</div>
<div class="line"><span class="lineno">  506</span>    <span class="keyword">using </span>SocketAddress = <span class="keyword">typename</span> HttpExpressServer::SocketAddress;</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>    <span class="keyword">const</span> HttpExpressServer httpExpressServer(instanceName, router);</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">if</span> (configurator != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  511</span>        configurator(httpExpressServer.getConfig());</div>
<div class="line"><span class="lineno">  512</span>    }</div>
<div class="line"><span class="lineno">  513</span>    httpExpressServer.listen([instanceName](<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> core::socket::State&amp; state) {</div>
<div class="line"><span class="lineno">  514</span>        <a class="code hl_function" href="mqttbroker_8cpp.html#a7cb8447e3290d506bf8a79ddeca2c7d0">reportState</a>(instanceName, socketAddress, state);</div>
<div class="line"><span class="lineno">  515</span>    });</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Instance: &quot;</span> &lt;&lt; instanceName;</div>
<div class="line"><span class="lineno">  518</span>    <span class="keywordflow">for</span> (std::string&amp; route : httpExpressServer.getRoutes()) {</div>
<div class="line"><span class="lineno">  519</span>        route.erase(std::remove(route.begin(), route.end(), <span class="charliteral">&#39;$&#39;</span>), route.end());</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; route;</div>
<div class="line"><span class="lineno">  522</span>    }</div>
<div class="line"><span class="lineno">  523</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a060eea8fb783d5b54f6fa11cf4e32be9" name="a060eea8fb783d5b54f6fa11cf4e32be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060eea8fb783d5b54f6fa11cf4e32be9">&#9670;&#160;</a></span>urlDecode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string urlDecode </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>encoded</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqttbroker_8cpp_source.html#l00238">238</a> of file <a class="el" href="mqttbroker_8cpp_source.html">mqttbroker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  238</span>                                                     {</div>
<div class="line"><span class="lineno">  239</span>    std::string decoded;</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">while</span> (i &lt; encoded.length()) {</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordtype">char</span> ch = encoded[i];</div>
<div class="line"><span class="lineno">  244</span>        <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;%&#39;</span>) {</div>
<div class="line"><span class="lineno">  245</span>            <span class="comment">// Make sure there are at least two characters after &#39;%&#39;</span></div>
<div class="line"><span class="lineno">  246</span>            <span class="keywordflow">if</span> (i + 2 &lt; encoded.length() &amp;&amp; std::isxdigit(encoded[i + 1]) &amp;&amp; std::isxdigit(encoded[i + 2])) {</div>
<div class="line"><span class="lineno">  247</span>                <span class="comment">// Convert the two hex digits to a character</span></div>
<div class="line"><span class="lineno">  248</span>                std::string hexValue = encoded.substr(i + 1, 2);</div>
<div class="line"><span class="lineno">  249</span>                <span class="keywordtype">char</span> decodedChar = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(std::stoi(hexValue, <span class="keyword">nullptr</span>, 16));</div>
<div class="line"><span class="lineno">  250</span>                decoded.push_back(decodedChar);</div>
<div class="line"><span class="lineno">  251</span>                i += 3; <span class="comment">// Skip over the % and the two hex digits</span></div>
<div class="line"><span class="lineno">  252</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  253</span>                <span class="comment">// Malformed encoding, just add the &#39;%&#39; as is.</span></div>
<div class="line"><span class="lineno">  254</span>                decoded.push_back(ch);</div>
<div class="line"><span class="lineno">  255</span>                ++i;</div>
<div class="line"><span class="lineno">  256</span>            }</div>
<div class="line"><span class="lineno">  257</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;+&#39;</span>) {</div>
<div class="line"><span class="lineno">  258</span>            <span class="comment">// Convert &#39;+&#39; to space (common in URL encoding)</span></div>
<div class="line"><span class="lineno">  259</span>            decoded.push_back(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><span class="lineno">  260</span>            ++i;</div>
<div class="line"><span class="lineno">  261</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  262</span>            <span class="comment">// Regular character, just append it.</span></div>
<div class="line"><span class="lineno">  263</span>            decoded.push_back(ch);</div>
<div class="line"><span class="lineno">  264</span>            ++i;</div>
<div class="line"><span class="lineno">  265</span>        }</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">return</span> decoded;</div>
<div class="line"><span class="lineno">  269</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6923aae39fdce29699351e77c1fed0e3.html">mqttbroker</a></li><li class="navelem"><a class="el" href="mqttbroker_8cpp.html">mqttbroker.cpp</a></li>
    <li class="footer">Generated on Sat Apr 26 2025 15:45:33 for MQTTSuite by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
